<div class="aisort-main-block">
    <div class="year-slider">
        <label class="title-filter" for="year-range">Выберите год:</label>
        <div id="year-range"></div>
    </div>
    <div class="filter-group status-select">
        <label class="title-filter-select" for="status-select">Выберите статус:</label>
        <div class="checkboxes">
            <label><input type="checkbox" value="Завершён"> Завершён</label>
            <label><input type="checkbox" value="Онгоинг"> Онгоинг</label>
            <label><input type="checkbox" value="Анонс"> Анонс</label>
        </div>
    </div>
    <div class="filter-group status-select">
        <label class="title-filter-select" for="type-select">Выберите тип:</label>
        <div class="checkboxes">
            <label><input type="checkbox" value="Сериал"> Сериал</label>
            <label><input type="checkbox" value="Фильм"> Фильм</label>
            <label><input type="checkbox" value="OVA"> OVA</label>
            <label><input type="checkbox" value="ONA"> ONA</label>
            <label><input type="checkbox" value="AMV"> AMV</label>
        </div>
    </div>
    <div class="filter-group status-select">
        <label class="title-filter-select" for="year-select">Выберите год:</label>
        <div class="checkboxes">
            <label><input type="checkbox" value="2025"> 2025</label>
            <label><input type="checkbox" value="2024"> 2024</label>
            <label><input type="checkbox" value="2023"> 2023</label>
            <label><input type="checkbox" value="2022"> 2022</label>
            <label><input type="checkbox" value="2021"> 2021</label>
            <label><input type="checkbox" value="2020"> 2020</label>
            <label><input type="checkbox" value="2019"> 2019</label>
            <label><input type="checkbox" value="2018"> 2018</label>
            <label><input type="checkbox" value="2017"> 2017</label>
            <label><input type="checkbox" value="2016"> 2016</label>
            <label><input type="checkbox" value="2015"> 2015</label>
            <label><input type="checkbox" value="2014"> 2014</label>
            <label><input type="checkbox" value="2013"> 2013</label>
            <label><input type="checkbox" value="2012"> 2012</label>
            <label><input type="checkbox" value="2011"> 2011</label>
            <label><input type="checkbox" value="2010"> 2010</label>
            <label><input type="checkbox" value="2009"> 2009</label>
            <label><input type="checkbox" value="2008"> 2008</label>
            <label><input type="checkbox" value="2007"> 2007</label>
            <label><input type="checkbox" value="2006"> 2006</label>
            <label><input type="checkbox" value="2005"> 2005</label>
            <label><input type="checkbox" value="2004"> 2004</label>
            <label><input type="checkbox" value="2003"> 2003</label>
            <label><input type="checkbox" value="2002"> 2002</label>
            <label><input type="checkbox" value="2001"> 2001</label>
            <label><input type="checkbox" value="2000"> 2000</label>
            <label><input type="checkbox" value="1999"> 1999</label>
            <label><input type="checkbox" value="1998"> 1998</label>
            <label><input type="checkbox" value="1997"> 1997</label>
            <label><input type="checkbox" value="1996"> 1996</label>
            <label><input type="checkbox" value="1995"> 1995</label>
            <label><input type="checkbox" value="1994"> 1994</label>
            <label><input type="checkbox" value="1993"> 1993</label>
            <label><input type="checkbox" value="1992"> 1992</label>
            <label><input type="checkbox" value="1991"> 1991</label>
            <label><input type="checkbox" value="1990"> 1990</label>
        </div>
    </div>
    <div class="filter-group status-select">
        <label class="title-filter-select" for="genre-select">Выберите жанр:</label>
        <div class="checkboxes">
            <label><input type="checkbox" value="безумие"> безумие</label>
            <label><input type="checkbox" value="боевые искусства"> боевые искусства</label>
            <label><input type="checkbox" value="вампиры"> вампиры</label>
            <label><input type="checkbox" value="военное"> военное</label>
            <label><input type="checkbox" value="гарем"> гарем</label>
            <label><input type="checkbox" value="гурман"> гурман</label>
            <label><input type="checkbox" value="демоны"> демоны</label>
            <label><input type="checkbox" value="детектив"> детектив</label>
            <label><input type="checkbox" value="детское"> детское</label>
            <label><input type="checkbox" value="дзёсей"> дзёсей</label>
            <label><input type="checkbox" value="драма"> драма</label>
            <label><input type="checkbox" value="игры"> игры</label>
            <label><input type="checkbox" value="исторический"> исторический</label>
            <label><input type="checkbox" value="комедия"> комедия</label>
            <label><input type="checkbox" value="космос"> космос</label>
            <label><input type="checkbox" value="магия"> магия</label>
            <label><input type="checkbox" value="машины"> машины</label>
            <label><input type="checkbox" value="меха"> меха</label>
            <label><input type="checkbox" value="музыка"> музыка</label>
            <label><input type="checkbox" value="пародия"> пародия</label>
            <label><input type="checkbox" value="повседневность"> повседневность</label>
            <label><input type="checkbox" value="полиция"> полиция</label>
            <label><input type="checkbox" value="приключения"> приключения</label>
            <label><input type="checkbox" value="психологическое"> психологическое</label>
            <label><input type="checkbox" value="работа"> работа</label>
            <label><input type="checkbox" value="романтика"> романтика</label>
            <label><input type="checkbox" value="самураи"> самураи</label>
            <label><input type="checkbox" value="сверхъестественное"> сверхъестественное</label>
            <label><input type="checkbox" value="спорт"> спорт</label>
            <label><input type="checkbox" value="супер сила"> супер сила</label>
            <label><input type="checkbox" value="сэйнэн"> сэйнэн</label>
            <label><input type="checkbox" value="сёдзё"> сёдзё</label>
            <label><input type="checkbox" value="сёдзё-ай"> сёдзё-ай</label>
            <label><input type="checkbox" value="сёнен"> сёнен</label>
            <label><input type="checkbox" value="сёнен-ай"> сёнен-ай</label>
            <label><input type="checkbox" value="триллер"> триллер</label>
            <label><input type="checkbox" value="ужасы"> ужасы</label>
            <label><input type="checkbox" value="фантастика"> фантастика</label>
            <label><input type="checkbox" value="фэнтези"> фэнтези</label>
            <label><input type="checkbox" value="школа"> школа</label>
            <label><input type="checkbox" value="экшен"> экшен</label>
            <label><input type="checkbox" value="этти"> этти</label>
        </div>
    </div>
    <button class="search-button">Искать</button>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/14.7.0/nouislider.min.js"></script>
<script>
const yearRange = document.getElementById('year-range');

noUiSlider.create(yearRange, {
    start: [1990, 2024],
    connect: true,
    step: 1,
    range: {
        'min': 1990,
        'max': 2024
    },
    pips: {
        mode: 'values',
        values: [1990, 2000, 2010, 2020, 2024],
        density: 5,
        format: {
            to: function (value) {
                return value;
            },
            from: function (value) {
                return value;
            }
        }
    }
});

yearRange.querySelectorAll('.noUi-handle').forEach((handle, index) => {
    const tooltip = document.createElement('div');
    tooltip.classList.add('noUi-tooltip');
    handle.appendChild(tooltip);

    handle.setAttribute('aria-valuetext', `${yearRange.noUiSlider.get()[index]}`);

    yearRange.noUiSlider.on('update', (values, handleNumber) => {
        if (index === handleNumber) {
            tooltip.innerText = `${Math.round(values[handleNumber])}`;
        }
    });
});

const searchButton = document.querySelector('.search-button');
searchButton.addEventListener('click', function () {
    const rangeValues = yearRange.noUiSlider.get();
    alert('Выбранный диапазон годов: ' + rangeValues.join(' - '));
});
</script>

<script>
    const selectedYear = document.getElementById('selected-year');
    const filterGroups = document.querySelectorAll('.filter-group');

    filterGroups.forEach(group => {
        const label = group.querySelector('label');
        const checkboxes = group.querySelector('.checkboxes');

        label.addEventListener('click', function () {
            // При клике на метку показываем или скрываем меню
            checkboxes.style.display = checkboxes.style.display === 'flex' ? 'none' : 'flex';
            
            // Закрываем предыдущее меню, если оно было открыто
            //filterGroups.forEach(otherGroup => {
            //   const otherCheckboxes = otherGroup.querySelector('.checkboxes');
            //      if (otherCheckboxes !== checkboxes) {
            //       otherCheckboxes.style.display = 'none';
            //}
            //});
        });
    });

    document.addEventListener('click', function (event) {
        // При клике вне меню закрываем все меню
        if (!event.target.closest('.filter-group')) {
            filterGroups.forEach(group => {
                const checkboxes = group.querySelector('.checkboxes');
                checkboxes.style.display = 'none';
            });
        }
    });
</script>